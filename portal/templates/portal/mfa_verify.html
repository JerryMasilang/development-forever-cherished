{% extends "portal/base_auth.html" %}
{% block title %}Two-Factor Verification{% endblock %}
{% block content %}

<div class="card shadow-sm w-100">
  <div class="card-body p-4 p-md-5">

    <h3 class="mb-2">Two-Factor Verification</h3>

    {% if method == "totp" %}
      <p class="text-muted mb-4">Enter the 6-digit code from your authenticator app.</p>

      <form method="post">
        {% csrf_token %}
        <div class="mb-3">
          <label class="form-label">Authenticator Code</label>
          <input name="token" class="form-control" inputmode="numeric" autocomplete="one-time-code" required>
        </div>
        <button class="btn btn-primary w-100">Verify</button>
      </form>

      {% if fallback_enabled %}
        <div class="mt-3 text-center">
          <a class="small" href="{% url 'portal:mfa_verify' %}?use=email">
            Can’t use authenticator? Use email instead
          </a>
        </div>
      {% endif %}

    {% elif method == "email" %}
      <p class="text-muted mb-4">We’ll send a one-time code to your email address.</p>

      <form method="post" class="mb-3">
        {% csrf_token %}
        <input type="hidden" name="action" value="send">
        <button class="btn btn-outline-primary w-100">Send Code</button>
      </form>

      <form method="post">
        {% csrf_token %}
        <div class="mb-3">
          <label class="form-label">Email Code</label>
          <input name="code" class="form-control" inputmode="numeric" autocomplete="one-time-code" required>
        </div>
        <button class="btn btn-primary w-100">Verify</button>
      </form>

      {% if fallback_enabled and has_totp %}
        <div class="mt-3 text-center">
          <a class="small" href="{% url 'portal:mfa_verify' %}?use=totp">
            Can’t access email? Use authenticator instead
          </a>
        </div>
      {% endif %}
    {% endif %}

    <hr class="my-4">

    <div class="text-center">
      <a class="small" href="{% url 'portal:mfa_recovery' %}">Use a recovery code instead</a>
    </div>

  </div>
</div>

{% endblock %}
