{% load static %}
<!doctype html>
<html lang="en" data-theme="{% if request.user.is_authenticated %}{{ request.user.profile.theme_preference|default:'system' }}{% else %}system{% endif %}">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{% block title %}QR Portal{% endblock %} | Forever Cherished</title>
    <script>
      (function () {
        var root = document.documentElement;
        var theme = root.getAttribute("data-theme") || "system";
        var isDark = (theme === "dark") || (theme === "system" && window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches);
        if (isDark) root.classList.add("theme-dark");
        else root.classList.remove("theme-dark");
      })();
    </script>

    <!-- Bootstrap -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
      rel="stylesheet"
    />
    <link href="{% static 'portal/css/portal.css' %}" rel="stylesheet" />

  </head>

  <body class="bg-light">
    <!-- Minimal Navbar for Auth pages -->
    <nav class="navbar border-bottom">
      <div
        class="container-fluid d-flex justify-content-between align-items-center"
      >

      <span class="navbar-brand fw-semibold mb-0">
        <span class="brand-title">Forever Cherished</span>
        <span class="brand-subtitle">| QR Portal</span>
      </span>



        {% if request.user.is_authenticated %}
        <div class="d-flex align-items-center gap-2">
          <span class="text-muted small">
            {{ request.user.email|default:request.user.username }}
          </span>

          <form method="post" action="{% url 'portal:logout' %}" class="d-inline">
            {% csrf_token %}
            <button type="submit" class="btn btn-outline-secondary btn-sm">
              Logout
            </button>
          </form>
        </div>
        {% endif %}
      </div>
    </nav>

    <!-- Page body -->
      <main class="auth-shell py-4 py-md-5">
        <div class="auth-wrap w-100 px-3">

        <!-- âœ… Show Django messages ONCE for auth pages -->
        {% if messages %} {% for message in messages %}
        <div
          class="alert alert-{% if message.tags %}{{ message.tags }}{% else %}info{% endif %} mb-3"
          role="alert"
        >
          {{ message }}
        </div>
        {% endfor %} {% endif %} {% block content %}{% endblock %}
      </div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html> 


