{% extends "portal/base_auth.html" %} {% block title %}Set up Authenticator{%endblock %} {% block content %}
<div class="card shadow-sm">
  <div class="card-body p-4">
    <h3 class="mb-2">Secure your account</h3>

    {% if mode == "setup" %}
    <p class="text-muted">
      Scan this QR code using Google Authenticator, Microsoft Authenticator, or
      any compatible app.
    </p>

    <div class="text-center my-4">
      <img
        src="{{ qr_url }}"
        class="img-fluid border p-2 rounded bg-white"
        style="max-width: 260px"
        alt="MFA QR Code"
      />
    </div>
    {% else %}
    <p class="text-muted">
      Enter the 6-digit code from your authenticator app to continue.
    </p>
    {% endif %}

    <form method="post" action="{% url 'portal:mfa_verify' %}">
      {% csrf_token %}

      <label class="form-label">6-digit code</label>
      <input
        type="text"
        name="token"
        class="form-control"
        inputmode="numeric"
        pattern="[0-9]{6}"
        maxlength="6"
        required
      />

      <button type="submit" class="btn btn-success w-100 mt-3">
        Verify & Activate
      </button>
    </form>
  </div>
</div>
{% endblock %}
